

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Framework.OSS.xmltodict &mdash; Warrior Ninja documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Warrior Ninja documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../warrior_index.html" class="icon icon-home"> Warrior
          

          
          </a>

          
            
            
              <div class="version">
                Ninja
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Actions.html">Actions package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Framework.html">Framework package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../warrior_index.html">Warrior</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../warrior_index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>Framework.OSS.xmltodict</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for Framework.OSS.xmltodict</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="s2">&quot;Makes working with XML feel like you are working with JSON&quot;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Copyright (C) 2012 Martin Blech and individual contributors.</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">defusedexpat</span> <span class="k">import</span> <span class="n">pyexpat</span> <span class="k">as</span> <span class="n">expat</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">xml.parsers</span> <span class="k">import</span> <span class="n">expat</span>
<span class="kn">from</span> <span class="nn">xml.sax.saxutils</span> <span class="k">import</span> <span class="n">XMLGenerator</span>
<span class="kn">from</span> <span class="nn">xml.sax.xmlreader</span> <span class="k">import</span> <span class="n">AttributesImpl</span>
<span class="k">try</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="kn">from</span> <span class="nn">cStringIO</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">StringIO</span> <span class="k">import</span> <span class="n">StringIO</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="k">try</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">ordereddict</span> <span class="k">import</span> <span class="n">OrderedDict</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">OrderedDict</span> <span class="o">=</span> <span class="nb">dict</span>

<span class="k">try</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="n">_basestring</span> <span class="o">=</span> <span class="n">basestring</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="n">_basestring</span> <span class="o">=</span> <span class="nb">str</span>
<span class="k">try</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="n">_unicode</span> <span class="o">=</span> <span class="n">unicode</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
    <span class="n">_unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Martin Blech&#39;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.10.2&#39;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s1">&#39;MIT&#39;</span>


<div class="viewcode-block" id="ParsingInterrupted"><a class="viewcode-back" href="../../../Framework.OSS.html#Framework.OSS.xmltodict.ParsingInterrupted">[docs]</a><span class="k">class</span> <span class="nc">ParsingInterrupted</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>


<span class="k">class</span> <span class="nc">_DictSAXHandler</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">item_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">item_callback</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">xml_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">attr_prefix</span><span class="o">=</span><span class="s1">&#39;@&#39;</span><span class="p">,</span>
                 <span class="n">cdata_key</span><span class="o">=</span><span class="s1">&#39;#text&#39;</span><span class="p">,</span>
                 <span class="n">force_cdata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">cdata_separator</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">postprocessor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dict_constructor</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">,</span>
                 <span class="n">strip_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">namespace_separator</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
                 <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">force_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_depth</span> <span class="o">=</span> <span class="n">item_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xml_attribs</span> <span class="o">=</span> <span class="n">xml_attribs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_callback</span> <span class="o">=</span> <span class="n">item_callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr_prefix</span> <span class="o">=</span> <span class="n">attr_prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdata_key</span> <span class="o">=</span> <span class="n">cdata_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_cdata</span> <span class="o">=</span> <span class="n">force_cdata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdata_separator</span> <span class="o">=</span> <span class="n">cdata_separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postprocessor</span> <span class="o">=</span> <span class="n">postprocessor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_constructor</span> <span class="o">=</span> <span class="n">dict_constructor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="o">=</span> <span class="n">strip_whitespace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namespace_separator</span> <span class="o">=</span> <span class="n">namespace_separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span> <span class="o">=</span> <span class="n">namespaces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_list</span> <span class="o">=</span> <span class="n">force_list</span>

    <span class="k">def</span> <span class="nf">_build_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">full_name</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace_separator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">full_name</span>
        <span class="n">namespace</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">full_name</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">full_name</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">short_namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">short_namespace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace_separator</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">short_namespace</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_attrs_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">attrs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_constructor</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">attrs</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">startElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_name</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_attrs_to_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">attrs</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_depth</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml_attribs</span><span class="p">:</span>
                <span class="n">attr_entries</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_prefix</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessor</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="p">:</span>
                        <span class="n">attr_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_constructor</span><span class="p">(</span><span class="n">attr_entries</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attrs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">attrs</span> <span class="ow">or</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">endElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_name</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_depth</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
                        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdata_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

            <span class="n">should_continue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">should_continue</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ParsingInterrupted</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdata_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip_whitespace</span> <span class="ow">and</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_cdata</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_constructor</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">push_data</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdata_key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">characters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">push_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_constructor</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">data</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_force_list</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
                <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span> <span class="nf">_should_force_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_list</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<div class="viewcode-block" id="parse"><a class="viewcode-back" href="../../../Framework.OSS.html#Framework.OSS.xmltodict.parse">[docs]</a><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">xml_input</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expat</span><span class="o">=</span><span class="n">expat</span><span class="p">,</span> <span class="n">process_namespaces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">namespace_separator</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse the given XML input and convert it into a dictionary.</span>

<span class="sd">    `xml_input` can either be a `string` or a file-like object.</span>

<span class="sd">    If `xml_attribs` is `True`, element attributes are put in the dictionary</span>
<span class="sd">    among regular child elements, using `@` as a prefix to avoid collisions. If</span>
<span class="sd">    set to `False`, they are just ignored.</span>

<span class="sd">    Simple example::</span>

<span class="sd">        &gt;&gt;&gt; import xmltodict</span>
<span class="sd">        &gt;&gt;&gt; doc = xmltodict.parse(\&quot;\&quot;\&quot;</span>
<span class="sd">        ... &lt;a prop=&quot;x&quot;&gt;</span>
<span class="sd">        ...   &lt;b&gt;1&lt;/b&gt;</span>
<span class="sd">        ...   &lt;b&gt;2&lt;/b&gt;</span>
<span class="sd">        ... &lt;/a&gt;</span>
<span class="sd">        ... \&quot;\&quot;\&quot;)</span>
<span class="sd">        &gt;&gt;&gt; doc[&#39;a&#39;][&#39;@prop&#39;]</span>
<span class="sd">        u&#39;x&#39;</span>
<span class="sd">        &gt;&gt;&gt; doc[&#39;a&#39;][&#39;b&#39;]</span>
<span class="sd">        [u&#39;1&#39;, u&#39;2&#39;]</span>

<span class="sd">    If `item_depth` is `0`, the function returns a dictionary for the root</span>
<span class="sd">    element (default behavior). Otherwise, it calls `item_callback` every time</span>
<span class="sd">    an item at the specified depth is found and returns `None` in the end</span>
<span class="sd">    (streaming mode).</span>

<span class="sd">    The callback function receives two parameters: the `path` from the document</span>
<span class="sd">    root to the item (name-attribs pairs), and the `item` (dict). If the</span>
<span class="sd">    callback&#39;s return value is false-ish, parsing will be stopped with the</span>
<span class="sd">    :class:`ParsingInterrupted` exception.</span>

<span class="sd">    Streaming example::</span>

<span class="sd">        &gt;&gt;&gt; def handle(path, item):</span>
<span class="sd">        ...     print &#39;path:%s item:%s&#39; % (path, item)</span>
<span class="sd">        ...     return True</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; xmltodict.parse(\&quot;\&quot;\&quot;</span>
<span class="sd">        ... &lt;a prop=&quot;x&quot;&gt;</span>
<span class="sd">        ...   &lt;b&gt;1&lt;/b&gt;</span>
<span class="sd">        ...   &lt;b&gt;2&lt;/b&gt;</span>
<span class="sd">        ... &lt;/a&gt;\&quot;\&quot;\&quot;, item_depth=2, item_callback=handle)</span>
<span class="sd">        path:[(u&#39;a&#39;, {u&#39;prop&#39;: u&#39;x&#39;}), (u&#39;b&#39;, None)] item:1</span>
<span class="sd">        path:[(u&#39;a&#39;, {u&#39;prop&#39;: u&#39;x&#39;}), (u&#39;b&#39;, None)] item:2</span>

<span class="sd">    The optional argument `postprocessor` is a function that takes `path`,</span>
<span class="sd">    `key` and `value` as positional arguments and returns a new `(key, value)`</span>
<span class="sd">    pair where both `key` and `value` may have changed. Usage example::</span>

<span class="sd">        &gt;&gt;&gt; def postprocessor(path, key, value):</span>
<span class="sd">        ...     try:</span>
<span class="sd">        ...         return key + &#39;:int&#39;, int(value)</span>
<span class="sd">        ...     except (ValueError, TypeError):</span>
<span class="sd">        ...         return key, value</span>
<span class="sd">        &gt;&gt;&gt; xmltodict.parse(&#39;&lt;a&gt;&lt;b&gt;1&lt;/b&gt;&lt;b&gt;2&lt;/b&gt;&lt;b&gt;x&lt;/b&gt;&lt;/a&gt;&#39;,</span>
<span class="sd">        ...                 postprocessor=postprocessor)</span>
<span class="sd">        OrderedDict([(u&#39;a&#39;, OrderedDict([(u&#39;b:int&#39;, [1, 2]), (u&#39;b&#39;, u&#39;x&#39;)]))])</span>

<span class="sd">    You can pass an alternate version of `expat` (such as `defusedexpat`) by</span>
<span class="sd">    using the `expat` parameter. E.g:</span>

<span class="sd">        &gt;&gt;&gt; import defusedexpat</span>
<span class="sd">        &gt;&gt;&gt; xmltodict.parse(&#39;&lt;a&gt;hello&lt;/a&gt;&#39;, expat=defusedexpat.pyexpat)</span>
<span class="sd">        OrderedDict([(u&#39;a&#39;, u&#39;hello&#39;)])</span>

<span class="sd">    You can use the force_list argument to force lists to be created even</span>
<span class="sd">    when there is only a single child of a given level of hierarchy. The</span>
<span class="sd">    force_list argument is a tuple of keys. If the key for a given level</span>
<span class="sd">    of hierarchy is in the force_list argument, that level of hierarchy</span>
<span class="sd">    will have a list as a child (even if there is only one sub-element).</span>
<span class="sd">    The index_keys operation takes precendence over this. This is applied</span>
<span class="sd">    after any user-supplied postprocessor has already run.</span>

<span class="sd">        For example, given this input:</span>
<span class="sd">        &lt;servers&gt;</span>
<span class="sd">          &lt;server&gt;</span>
<span class="sd">            &lt;name&gt;host1&lt;/name&gt;</span>
<span class="sd">            &lt;os&gt;Linux&lt;/os&gt;</span>
<span class="sd">            &lt;interfaces&gt;</span>
<span class="sd">              &lt;interface&gt;</span>
<span class="sd">                &lt;name&gt;em0&lt;/name&gt;</span>
<span class="sd">                &lt;ip_address&gt;10.0.0.1&lt;/ip_address&gt;</span>
<span class="sd">              &lt;/interface&gt;</span>
<span class="sd">            &lt;/interfaces&gt;</span>
<span class="sd">          &lt;/server&gt;</span>
<span class="sd">        &lt;/servers&gt;</span>

<span class="sd">        If called with force_list=(&#39;interface&#39;,), it will produce</span>
<span class="sd">        this dictionary:</span>
<span class="sd">        {&#39;servers&#39;:</span>
<span class="sd">          {&#39;server&#39;:</span>
<span class="sd">            {&#39;name&#39;: &#39;host1&#39;,</span>
<span class="sd">             &#39;os&#39;: &#39;Linux&#39;},</span>
<span class="sd">             &#39;interfaces&#39;:</span>
<span class="sd">              {&#39;interface&#39;:</span>
<span class="sd">                [ {&#39;name&#39;: &#39;em0&#39;, &#39;ip_address&#39;: &#39;10.0.0.1&#39; } ] } } }</span>

<span class="sd">        `force_list` can also be a callable that receives `path`, `key` and</span>
<span class="sd">        `value`. This is helpful in cases where the logic that decides whether</span>
<span class="sd">        a list should be forced is more complex.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">_DictSAXHandler</span><span class="p">(</span><span class="n">namespace_separator</span> <span class="o">=</span> <span class="n">namespace_separator</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xml_input</span><span class="p">,</span> <span class="n">_unicode</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">encoding</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
        <span class="n">xml_input</span> <span class="o">=</span> <span class="n">xml_input</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">process_namespaces</span><span class="p">:</span>
        <span class="n">namespace_separator</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">expat</span><span class="o">.</span><span class="n">ParserCreate</span><span class="p">(</span>
        <span class="n">encoding</span><span class="p">,</span>
        <span class="n">namespace_separator</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">ordered_attributes</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># Jython&#39;s expat does not support ordered_attributes</span>
        <span class="k">pass</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">StartElementHandler</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">startElement</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">EndElementHandler</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">endElement</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">CharacterDataHandler</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">characters</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">buffer_text</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">ParseFile</span><span class="p">(</span><span class="n">xml_input</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">xml_input</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handler</span><span class="o">.</span><span class="n">item</span></div>


<span class="k">def</span> <span class="nf">_emit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">content_handler</span><span class="p">,</span>
          <span class="n">attr_prefix</span><span class="o">=</span><span class="s1">&#39;@&#39;</span><span class="p">,</span>
          <span class="n">cdata_key</span><span class="o">=</span><span class="s1">&#39;#text&#39;</span><span class="p">,</span>
          <span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">preprocessor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">pretty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">newl</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="n">full_document</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">preprocessor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">result</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">_basestring</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">full_document</span> <span class="ow">and</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;document with multiple roots&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">_unicode</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">_basestring</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(((</span><span class="n">cdata_key</span><span class="p">,</span> <span class="n">v</span><span class="p">),))</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ik</span><span class="p">,</span> <span class="n">iv</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ik</span> <span class="o">==</span> <span class="n">cdata_key</span><span class="p">:</span>
                <span class="n">cdata</span> <span class="o">=</span> <span class="n">iv</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">ik</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">attr_prefix</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span> <span class="n">_unicode</span><span class="p">):</span>
                    <span class="n">iv</span> <span class="o">=</span> <span class="n">_unicode</span><span class="p">(</span><span class="n">iv</span><span class="p">)</span>
                <span class="n">attrs</span><span class="p">[</span><span class="n">ik</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">attr_prefix</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">iv</span>
                <span class="k">continue</span>
            <span class="n">children</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ik</span><span class="p">,</span> <span class="n">iv</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pretty</span><span class="p">:</span>
            <span class="n">content_handler</span><span class="o">.</span><span class="n">ignorableWhitespace</span><span class="p">(</span><span class="n">depth</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span>
        <span class="n">content_handler</span><span class="o">.</span><span class="n">startElement</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AttributesImpl</span><span class="p">(</span><span class="n">attrs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pretty</span> <span class="ow">and</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">content_handler</span><span class="o">.</span><span class="n">ignorableWhitespace</span><span class="p">(</span><span class="n">newl</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child_key</span><span class="p">,</span> <span class="n">child_value</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">_emit</span><span class="p">(</span><span class="n">child_key</span><span class="p">,</span> <span class="n">child_value</span><span class="p">,</span> <span class="n">content_handler</span><span class="p">,</span>
                  <span class="n">attr_prefix</span><span class="p">,</span> <span class="n">cdata_key</span><span class="p">,</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">,</span>
                  <span class="n">pretty</span><span class="p">,</span> <span class="n">newl</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cdata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">content_handler</span><span class="o">.</span><span class="n">characters</span><span class="p">(</span><span class="n">cdata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pretty</span> <span class="ow">and</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">content_handler</span><span class="o">.</span><span class="n">ignorableWhitespace</span><span class="p">(</span><span class="n">depth</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span>
        <span class="n">content_handler</span><span class="o">.</span><span class="n">endElement</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pretty</span> <span class="ow">and</span> <span class="n">depth</span><span class="p">:</span>
            <span class="n">content_handler</span><span class="o">.</span><span class="n">ignorableWhitespace</span><span class="p">(</span><span class="n">newl</span><span class="p">)</span>


<div class="viewcode-block" id="unparse"><a class="viewcode-back" href="../../../Framework.OSS.html#Framework.OSS.xmltodict.unparse">[docs]</a><span class="k">def</span> <span class="nf">unparse</span><span class="p">(</span><span class="n">input_dict</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">full_document</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Emit an XML document for the given `input_dict` (reverse of `parse`).</span>

<span class="sd">    The resulting XML document is returned as a string, but if `output` (a</span>
<span class="sd">    file-like object) is specified, it is written there instead.</span>

<span class="sd">    Dictionary keys prefixed with `attr_prefix` (default=`&#39;@&#39;`) are interpreted</span>
<span class="sd">    as XML node attributes, whereas keys equal to `cdata_key`</span>
<span class="sd">    (default=`&#39;#text&#39;`) are treated as character data.</span>

<span class="sd">    The `pretty` parameter (default=`False`) enables pretty-printing. In this</span>
<span class="sd">    mode, lines are terminated with `&#39;\n&#39;` and indented with `&#39;\t&#39;`, but this</span>
<span class="sd">    can be customized with the `newl` and `indent` parameters.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">full_document</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_dict</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Document must have exactly one root.&#39;</span><span class="p">)</span>
    <span class="n">must_return</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">must_return</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">content_handler</span> <span class="o">=</span> <span class="n">XMLGenerator</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_document</span><span class="p">:</span>
        <span class="n">content_handler</span><span class="o">.</span><span class="n">startDocument</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">input_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">_emit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">content_handler</span><span class="p">,</span> <span class="n">full_document</span><span class="o">=</span><span class="n">full_document</span><span class="p">,</span>
              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_document</span><span class="p">:</span>
        <span class="n">content_handler</span><span class="o">.</span><span class="n">endDocument</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">must_return</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># pragma no cover</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">value</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">marshal</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">buffer</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

    <span class="p">(</span><span class="n">item_depth</span><span class="p">,)</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">item_depth</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">item_depth</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">handle_item</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="n">marshal</span><span class="o">.</span><span class="n">dump</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">),</span> <span class="n">stdout</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span>
                     <span class="n">item_depth</span><span class="o">=</span><span class="n">item_depth</span><span class="p">,</span>
                     <span class="n">item_callback</span><span class="o">=</span><span class="n">handle_item</span><span class="p">,</span>
                     <span class="n">dict_constructor</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">handle_item</span><span class="p">([],</span> <span class="n">root</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, FNC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'Ninja',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>